{{ template "layouts/header" . }}
<h3>Job Definitions</h3>
A job definition defines a graph of tasks that are executed by remote ant executor using docker, kubernetes, shell commands
or APIs. The formicary supports GO templates for job definitions so you can use variables, if/else/ranges and the
values are passed from job parameters, configuration or job-context/results of previous tasks.
<form action="/dashboard/jobs/definitions" method="GET">
    <div class="form-group">
        <div class="form-group row">
            <input type="text" class="col-sm-3 form-control" name="q" id="q" value="{{ .Q }}" placeholder="Search job definitions">
            &nbsp;
            <button type="submit" class="col-sm-2 btn btn-primary">Search</button>
        </div>
    </div>
</form>

<div align="right">
    <form action="/dashboard/jobs/definitions/upload" method="POST" enctype="multipart/form-data">
        Load Files: <input type="file" name="files" multiple>
        <input type="submit" value="Upload Job Definition">
    </form>
</div>
<div class="table-responsive">
    <table class="table table-striped table-sm">
        <thead>
        <tr>
            <th class="col-sm-1">Job</th>
            <th class="col-sm-1">User</th>
            {{if false}}
            <th class="col-sm-1">Version</th>
            {{end}}
            <th class="col-sm-1">Methods</th>
            <th class="col-sm-1">Tags</th>
            {{if false}}
            <th class="col-sm-2">Tasks</th>
            {{end}}
            <th class="col-sm-1">Paused</th>
            <th class="col-sm-5">Actions</th>
        </tr>
        </thead>
        <tbody>
        {{range .Records}}
        <tr>
            <td class="col-sm-1"><a href="/dashboard/jobs/definitions/{{.ID}}">{{.ShortJobType}}</a></td>
            <td class="col-sm-1"><a href="/dashboard/users/{{.UserID}}">{{.ShortUserID}}</a></td>
            {{if false}}
            <td class="col-sm-1">{{.Version}}</td>
            {{end}}
            <td class="col-sm-1">{{.Methods}}</td>
            <td class="col-sm-1">{{.Tags}}</td>
            {{if false}}
            <td class="col-sm-2">{{.TaskNames}}</td>
            {{end}}
            <td class="col-sm-1">{{.Paused}}</td>
            <td class="group row">
                <form action="/dashboard/jobs/definitions/{{.ID}}" method="GET">
                    <input type="submit" class="btn btn-primary" value="View">
                </form>
                &nbsp;
                <form action="/dashboard/jobs/requests/new" method="GET">
                    <input type="submit" class="btn btn-secondary " value="Submit">
                    <input type="hidden" name="jobType" value="{{.JobType}}">
                </form>
                &nbsp;
                <form action="/dashboard/jobs/definitions/{{.ID}}/delete" method="POST" enctype="multipart/form-data"
                      onsubmit="return confirm('Please confirm deleting this job definition (' + this['id'].value + ')?');">
                    <input type="submit" class="btn btn-danger" value="Delete">
                    <input type="hidden" name="id" value="{{.JobType}}">
                </form>
                &nbsp;
                {{if .Paused }}
                <form action="/dashboard/jobs/definitions/{{.ID}}/unpause" method="POST" enctype="multipart/form-data">
                    <input type="submit" class="btn btn-warning" value="Unpause">
                </form>
                {{else}}
                <form action="/dashboard/jobs/definitions/{{.ID}}/pause" method="POST" enctype="multipart/form-data">
                    <input type="submit" class="btn btn-warning" value="Pause">
                </form>
                {{end}}
            </td>
        </tr>
        {{end}}
        </tbody>
    </table>
</div>
{{ template "layouts/pagination" .Pagination }}
{{ template "layouts/footer" }}
