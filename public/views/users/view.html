{{ template "layouts/header" . }}
<section class="group">
    <header class="group-header">
        <h4 class="group-title">User Profile</h4>
    </header>

    <div align="right">
        <a href="/dashboard/users/{{.User.ID}}/edit">Edit Profile</a>
    </div>
    {{ if .User.Admin }}
    <div class="form-group">
        <div class="row">
            <label class="col-sm-2 col-form-label">Admin: </label>
            <div class="col-sm-10">
                <b>{{ .User.Admin }}</b>
            </div>
        </div>
    </div>
    {{ end }}

    <div class="form-group">
        <div class="row">
            <label class="col-sm-2 col-form-label">ID: </label>
            <div class="col-sm-10">
                <b>{{ .User.ID }}</b>
            </div>
        </div>
    </div>

    <div class="form-group">
        <div class="row">
            <label class="col-sm-2 col-form-label">Username: </label>
            <div class="col-sm-10">
                <b>{{ .User.Username }}</b>
            </div>
        </div>
    </div>

    <div class="form-group">
        <div class="row">
            <label class="col-sm-2 col-form-label">Name: </label>
            <div class="col-sm-10">
                <b>{{ .User.Name }}</b>
            </div>
        </div>
    </div>

    <div class="form-group">
        <div class="row">
            <label class="col-sm-2 col-form-label">Email: </label>
            <div class="col-sm-10">
                <b>{{ .User.Email }}</b>
            </div>
        </div>
    </div>

    {{if .User.HasOrganization}}
    <div class="form-group">
        <div class="row">
            <label class="col-sm-2 col-form-label">Organization: </label>
            <div class="col-sm-10">
                <a href="/dashboard/orgs/{{.User.OrganizationID}}">{{.User.OrganizationID}}</a>
            </div>
        </div>
    </div>

    <div class="form-group">
        <div class="row">
            <label class="col-sm-2 col-form-label">Bundle: </label>
            <div class="col-sm-10">
                <b>{{ .User.BundleID }}</b>
            </div>
        </div>
    </div>
    {{ end }}

    {{ with .ResourcesUsage }}
    <h3>Resources Usage</h3>
    <div class="table-responsive">
        <table class="table table-sm table-border">
            <thead class="thead-dark">
            <tr>
                <th class="col-sm-2">Type</th>
                <th class="col-sm-2">Today</th>
                <th class="col-sm-2">Week</th>
                <th class="col-sm-2">Month</th>
                <th class="col-sm-2">All Time</th>
            </tr>
            </thead>
            {{range .}}
            <tr scope="row">
                <td>
                    <dt class="col-sm-2"><b>{{ .Type }}:</b></dt>
                </td>
                <td>
                    <dd class="col-sm-1">{{ .Today.DateString }}</dd>
                    <dd class="col-sm-1">{{ .Today.ValueString }}</dd>
                </td>
                <td>
                    <dd class="col-sm-1">{{ .Week.DateString }}</dd>
                    <dd class="col-sm-1">{{ .Week.ValueString }}</dd>
                </td>
                <td>
                    <dd class="col-sm-1">{{ .Month.DateString }}</dd>
                    <dd class="col-sm-1">{{ .Month.ValueString }}</dd>
                </td>
                <td>
                    <dd class="col-sm-2">{{ .All.ValueString }}</dd>
                </td>
            </tr>
            {{ end }}
        </table>
    </div>
    {{ end }}

    {{ with .DBUser }}
    <h3>API Tokens</h3>
    <div align="right">
        <a href="/dashboard/users/{{.ID}}/tokens/new">New API Token</a>
    </div>
    <div class="table-responsive">
        <table class="table table-sm table-border">
            <thead class="thead-dark">
            <tr>
                <th class="col-sm-2">Name</th>
                <th class="col-sm-2">Created</th>
                <th class="col-sm-2">Expires</th>
                <th class="col-sm-2">Actions</th>
            </tr>
            </thead>
            {{range $.Tokens}}
            <tr scope="row">
                <td>
                    <dt class="col-sm-2"><b>{{ .TokenName }}:</b></dt>
                </td>
                <td>
                    <dd class="col-sm-2">{{ .CreatedAt }}</dd>
                </td>
                <td>
                    <dd class="col-sm-2">{{ .ExpiresAt }}</dd>
                </td>
                <td class="group row col-sm-2">
                    <form action="/dashboard/users/{{.UserID}}/tokens/{{.ID}}/delete" method="POST" enctype="multipart/form-data"
                          onsubmit="return confirm('Please confirm revoking this token(' + this['id'].value + ')?');">
                        <input type="submit" class="btn btn-danger" value="Delete">
                        <input type="hidden" name="id" value="{{.TokenName}}">
                    </form>
                </td>
            </tr>
            {{ end }}
        </table>
    </div>
    {{end}}

    {{if .Admin}}
    Permissions
    <div class="table-responsive">
        <table class="table table-sm table-border">
            <thead class="thead-dark">
            <tr>
                <th class="col-sm-2">Resource</th>
                <th class="col-sm-4">Actions</th>
            </tr>
            </thead>
            {{range .User.PermissionList}}
            {{ if .NotEmpty }}
            <tr scope="row">
                <td class="col-sm-2">
                    <dt class="col-sm-2"><b>{{ .Resource }}:</b></dt>
                </td>
                <td class="col-sm-4">
                    <dd class="col-sm-4">{{ .LongAction }}</dd>
                </td>
            </tr>
            {{ end }}
            {{ end }}
        </table>
    </div>
    {{end}}
    <footer class="group-footer">
    </footer>

</section>
{{ template "layouts/footer" }}
