job_type: check-oidc
tasks:
- task_type: oidc
  script:
    - find /var/run
    - /bin/cosign sign --force --k8s-keychain {{.IMAGE}}
  environment:
    OLD_ENV_VAR: ijk
  container:
    image: gcr.io/projectsigstore/cosign:1.3.0 
    volumes:
      host_path:
        - name: mount1
          mount_path: /myshared
          host_path: /shared
      empty_dir:
        - name: mount2
          mount_path: /myempty
      projected:
        - name: oidc-info
          mount_path: /var/run/sigstore/cosign
          sources:
            - service_account_token:
                path: oidc-token
                expiration_seconds: 600 # Use as short-lived as possible.
                audience: sigstore
